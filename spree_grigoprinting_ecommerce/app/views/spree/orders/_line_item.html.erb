<% variant = line_item.variant %>
<% if line_item.padre.nil?  %>
  <div class="line-item row-form">
    <%= order_form.fields_for :line_items, line_item do |item_form| %>
      <div class="col-md-12">
        <div class="cart-item-image col-xs-3 col-md-1" data-hook="cart_item_image">
          <% if variant.images.length == 0 %>
            <%= link_to small_image(variant.product), variant.product %>
          <% else %>
            <%= link_to image_tag(variant.images.first.attachment.url(:small)), variant.product %>
          <% end %>
        </div>
        <div class="cart-item-description col-xs-12 col-md-6" data-hook="cart_item_description">
          <h4><%= link_to line_item.name, product_path(variant.product) %></h4>
          <%= variant.options_text %>
          <% if line_item.insufficient_stock? %>
            <span class="out-of-stock">
              <%= Spree.t(:out_of_stock) %>&nbsp;&nbsp;<br />
            </span>
          <% end %>
          <span class="line-item-description" data-hook="line_item_description">
            <%= line_item.description.html_safe %>
          </span>
        </div>
        <div class="text-primary cart-item-pric col-md-1" data-hook="cart_item_price">
          <%= line_item.single_money.to_html %>
        </div>
        <div class="cart-item-quantity col-xs-6 col-md-1" data-hook="cart_item_quantity" valign="center">
          <%= item_form.number_field :quantity, min: 0, class: "form-control line_item_quantity", size: 5 %>
        </div>
        <div class="text-primary cart-item-total col-xs-6 col-md-2" data-hook="cart_item_total">
          <%= line_item.display_amount.to_html unless line_item.quantity.nil? %>
        </div>
        <div class="cart-item-delete col-xs-12 col-md-1" data-hook="cart_item_delete">
          <%= link_to content_tag(:span, '', class: 'glyphicon glyphicon-trash'), '#', class: 'delete', id: "delete_#{dom_id(line_item)}" %>
        </div>
      </div>
    <% end %>
    <% line_item.figli.each do |figlio| %>
      <% variant = figlio.variant %>
      <%= order_form.fields_for :line_items, figlio do |item_form| %>
        <div class="col-md-12">
          <div class="cart-item-image col-xs-3 col-md-1 col-md-offset-1" data-hook="cart_item_image">
            <% if variant.images.length == 0 %>
              <%= link_to small_image(variant.product), variant.product %>
            <% else %>
              <%= link_to image_tag(variant.images.first.attachment.url(:small)), variant.product %>
            <% end %>
          </div>
          <div class="cart-item-description col-xs-12 col-md-5" data-hook="cart_item_description">
            <h4><%= link_to figlio.name, product_path(variant.product) %></h4>
            <%= variant.options_text %>
            <% if figlio.insufficient_stock? %>
              <span class="out-of-stock">
                <%= Spree.t(:out_of_stock) %>&nbsp;&nbsp;<br />
              </span>
            <% end %>
            <span class="line-item-description" data-hook="line_item_description">
              <%= figlio.description.html_safe %>
            </span>
          </div>
          <div class="text-primary cart-item-pric col-md-1" data-hook="cart_item_price">
            <%= figlio.single_money.to_html %>
          </div>
          <div class="cart-item-quantity col-xs-6 col-md-1" data-hook="cart_item_quantity" valign="center">
            <%= figlio.quantity %>
          </div>
          <div class="text-primary cart-item-total col-xs-6 col-md-2" data-hook="cart_item_total">
            <%= figlio.display_amount.to_html unless figlio.quantity.nil? %>
          </div>
          <div class="cart-item-delete col-xs-12 col-md-1" data-hook="cart_item_delete"></div>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>
